- step:
    name: load_data_fit
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.load_data("fit.sql")'

- step:
    name: load_data_predict
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.load_data("predict.sql")'

- step:
    name: consolidate_opps
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.consolidate_opps()'
    inputs:
      - name: loaded_data
        default: datum://017c69ed-31ca-9475-1fb1-c5df4e1ccd7c

- step:
    name: process_df
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.process_df()'
    inputs:
      - name: loaded_data
        default: datum://017c69fb-ce20-70cb-4c60-7860ce936737

- step:
    name: fit_rf
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.fit("rf")'
    inputs:
      - name: processed_data
        default: datum://017c692b-97f1-e890-9eef-7aeaf5e9e393

- step:
    name: fit_etc
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.fit("etc")'
    inputs:
      - name: processed_data
        default: datum://017c692b-97f1-e890-9eef-7aeaf5e9e393

- step:
    name: fit_cbc
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.fit("cbc")'
    inputs:
      - name: processed_data
        default: datum://017c692b-97f1-e890-9eef-7aeaf5e9e393

- step:
    name: choose
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.choose()'
    inputs:
      - name: rf
        default: datum://017c69cc-33bc-d215-90a7-0706e022fe10
      - name: etc
        default: datum://017c69b5-9db9-6522-c559-cbb83ac85829
      - name: cbc
        default: datum://017c69b4-1b15-5577-e3c4-e1731c52f8d8
      - name: rf_pr_auc
        default: datum://017c69cc-3485-05b7-47cb-a40a44378343
      - name: etc_pr_auc
        default: datum://017c69b5-9e86-10cb-7123-b562e7598c00
      - name: cbc_pr_auc
        default: datum://017c69b4-1bfd-b98a-9298-2e59da6c8129


- step:
    name: upload_to_s3
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.upload_to_s3()'
    inputs:
      - name: data_with_predictions
        default: datum://<DATUM_URL_FROM_STEP_EXECUTION>


- pipeline:
    name: dummy_pipeline
    nodes:
      - name: load_data
        type: execution
        step: load_data
      - name: step1
        type: execution
        step: dummy_step1
        override:
          inputs:
            - name: loaded_data
      - name: step2
        type: execution
        step: dummy_step2
        override:
          inputs:
            - name: processed_data
      - name: upload_to_s3
        type: execution
        step: upload_to_s3
        override:
          inputs:
            - name: data_with_predictions
    edges:
      - [load_data.output.*.csv, step1.inputs.loaded_data]
      - [step1.output.*.csv, step2.inputs.processed_data]
      - [step2.output.*.csv, data_with_predictions.inputs.data_with_predictions]