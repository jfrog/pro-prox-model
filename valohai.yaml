- step:
    name: load_data_fit
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.load_data("fit.sql")'

- step:
    name: load_data_predict
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.load_data("predict.sql")'

- step:
    name: consolidate_opps
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.consolidate_opps()'
    inputs:
      - name: loaded_data
        default: datum://017c6909-3bed-8508-0960-0c1b94513422

- step:
    name: process_df
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.process_df()'
    inputs:
      - name: loaded_data
        default: datum://017c691c-c491-1a8d-ae18-474c7c8cb260

- step:
    name: fit_rf
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.fit("rf")'
    inputs:
      - name: processed_data
        default: datum://017c692b-97f1-e890-9eef-7aeaf5e9e393

- step:
    name: fit_etc
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.fit("etc")'
    inputs:
      - name: processed_data
        default: datum://017c692b-97f1-e890-9eef-7aeaf5e9e393

- step:
    name: fit_cbc
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.fit("cbc")'
    inputs:
      - name: processed_data
        default: datum://017c692b-97f1-e890-9eef-7aeaf5e9e393

- step:
    name: choose
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.choose()'
    inputs:
      - name: rf
        default: datum://017a850c-a18c-607d-3091-b46673f3c821
      - name: etc
        default: datum://017a850b-3122-7bb6-c4df-b70eb06cda3c
      - name: cbc
        default: datum://017a8508-b61f-e9ea-a256-75f7b4caeada
      - name: rf_pr_auc
        default: datum://017a850c-a265-a5ba-d667-4c474bd93994
      - name: etc_pr_auc
        default: datum://017a850b-31dd-43fe-deed-8fef8c3aac34
      - name: cbc_pr_auc
        default: datum://017a8508-b6fb-989b-ac18-edb663f4e1bd


- step:
    name: upload_to_s3
    image: yotamljfrog/csat_model:0.3
    command:
      - pip install -r requirements.txt
      - python -c 'import main; main.upload_to_s3()'
    inputs:
      - name: data_with_predictions
        default: datum://<DATUM_URL_FROM_STEP_EXECUTION>


- pipeline:
    name: dummy_pipeline
    nodes:
      - name: load_data
        type: execution
        step: load_data
      - name: step1
        type: execution
        step: dummy_step1
        override:
          inputs:
            - name: loaded_data
      - name: step2
        type: execution
        step: dummy_step2
        override:
          inputs:
            - name: processed_data
      - name: upload_to_s3
        type: execution
        step: upload_to_s3
        override:
          inputs:
            - name: data_with_predictions
    edges:
      - [load_data.output.*.csv, step1.inputs.loaded_data]
      - [step1.output.*.csv, step2.inputs.processed_data]
      - [step2.output.*.csv, data_with_predictions.inputs.data_with_predictions]